"'Billing Screen' As screen":

    txtTipAmtInput As text:
        Default: =""
        Format: =TextFormat.Number
        Height: =34
        OnChange: |-
            =UpdateContext({tipVal: Value(txtTipAmtInput.Text)})
        OnSelect: |-
            =UpdateContext({tipCustomSelected: true});
        Width: =101
        X: =160
        Y: =483
        ZIndex: =1

    Button10_3 As button:
        DisplayMode: =DisplayMode.View
        Height: =34
        Text: ="Custom"
        Width: =89
        X: =61
        Y: =483
        ZIndex: =2

    Button10_2 As button:
        Height: =34
        OnSelect: |-
            =UpdateContext({tipVal: .20 * SelectedOrder.'Base Total'});
            UpdateContext({tipCustomSelected: false});
            Reset(txtTipAmtInput)
        Text: ="20%"
        Width: =89
        X: =261
        Y: =435
        ZIndex: =3

    Button10_1 As button:
        Height: =34
        OnSelect: |-
            =UpdateContext({tipVal: .15 * SelectedOrder.'Base Total'});
            UpdateContext({tipCustomSelected: false});
            Reset(txtTipAmtInput)
        Text: ="15%"
        Width: =89
        X: =160
        Y: =435
        ZIndex: =4

    Button10 As button:
        Height: =34
        OnSelect: |-
            =UpdateContext({tipVal: .10 * SelectedOrder.'Base Total'});
            UpdateContext({tipCustomSelected: false});
            Reset(txtTipAmtInput)
        Text: ="10%"
        Width: =89
        X: =61
        Y: =434
        ZIndex: =5

    lblDiscount As label:
        Height: =37
        LineHeight: =1.5
        Text: |-
            ="Discount: " & 
                Text(SelectedOrder.'Base Total' * SelectedOrder.Discount,"$#0.#0 ") &
                Text(SelectedOrder.Discount * 100, "(#0%)")
        Width: =204
        X: =951
        Y: =403
        ZIndex: =6

    "Gallery1 As gallery.'BrowseLayout_Vertical_TwoTextVariant_ver4.0'":
        BorderColor: =RGBA(118, 0, 0, 1)
        Height: =222
        Items: =Filter('Order Details', 'Order ID' = Value(SelectedOrder.'Order Number'))
        Layout: =Layout.Vertical
        TemplatePadding: =0
        TemplateSize: =28
        Width: =1366
        Y: =45
        ZIndex: =7

        Title2 As label:
            Height: =25
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =15
            Text: =ThisItem.'Menu Item'.Name
            VerticalAlign: =VerticalAlign.Top
            Width: =310
            X: =32
            ZIndex: =1

        lblPrice As label:
            Height: =25
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =12
            Text: |-
                =Text(ThisItem.'Menu Item'.Price, "$##.#0")
            VerticalAlign: =VerticalAlign.Top
            Width: =81
            X: =1053
            Y: =4
            ZIndex: =2

        Separator5 As rectangle:
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =4

    btnBPay As button:
        Height: =48
        OnSelect: |
            =UpdateContext({BackgroundBlurVisble: true});
            UpdateContext({PTWindowVisible: true}); // PT = Payment Type
            UpdateContext({tipVal: 0});
            Patch(Orders, LookUp(Orders, 'Order Number' = SelectedOrder.'Order Number'), {Tip: Value(txtTipAmtInput.Text)});
        Text: ="Pay"
        Width: =184
        X: =951
        Y: =575
        ZIndex: =8

    txtBTotal As label:
        LineHeight: =1.5
        Text: |-
            ="Total: " & Text(Sum(SelectedOrder.'Grand Total', tipVal), "$##.00")
        X: =948
        Y: =522
        ZIndex: =9

    txtBTip As label:
        LineHeight: =1.5
        Text: |-
            ="Tip: " & Text(Value(tipVal), "$#0.#0")
        X: =951
        Y: =487
        ZIndex: =10

    txtBTax As label:
        LineHeight: =1.5
        Text: |-
            ="Tax: " & Text(SelectedOrder.Tax,"$##.#0")
        X: =951
        Y: =440
        ZIndex: =11

    txtBSubtotal As label:
        LineHeight: =1.5
        Text: |-
            ="Subtotal: " & Text(SelectedOrder.'Base Total',"$##.#0")
        X: =948
        Y: =366
        ZIndex: =12

    Label4 As label:
        Align: =Align.Center
        Fill: =RGBA(216, 59, 1, 1)
        FontWeight: =FontWeight.Bold
        Height: =45
        Size: =23
        Text: |-
            ="Order # " & Text(SelectedOrder.'Order Number')
        Width: =1366
        ZIndex: =13

    btnBPay_1 As button:
        Height: =27
        OnSelect: |-
            =UpdateContext({DiscountWindowVisble: true});
            UpdateContext({BackgroundBlurVisble: true});
        Text: ="Discount"
        Width: =114
        X: =1235
        Y: =9
        ZIndex: =14

    Icon1 As icon.ArrowLeft:
        Height: =27
        Icon: =Icon.ArrowLeft
        OnSelect: |-
            =Navigate('Orders List Screen', None);
            Reset(txtTipAmtInput)
        Width: =61
        ZIndex: =15

    LightOutbg As rectangle:
        Fill: =RGBA(153, 153, 153, 0.7)
        Height: =768
        OnSelect: =
        Visible: =BackgroundBlurVisble
        Width: =1366
        ZIndex: =16

    Rectangle2 As rectangle:
        Fill: =RGBA(216, 59, 1, 1)
        Height: =45
        Width: =1366
        Y: =723
        ZIndex: =17

    CashCreditWindow As rectangle:
        BorderColor: =RGBA(216, 59, 1, 1)
        BorderThickness: =5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =189
        Visible: =PTWindowVisible
        Width: =480
        X: =461
        Y: =337
        ZIndex: =18

    btnCash As button:
        Height: =66
        OnSelect: |-
            =UpdateContext({PTWindowVisible: false});
            UpdateContext({CashWindowVisible: true});
        Text: ="Cash"
        Visible: =PTWindowVisible
        Width: =181
        X: =506
        Y: =403
        ZIndex: =19

    btnCredit As button:
        Height: =66
        OnSelect: |-
            =UpdateContext({PTWindowVisible: false}); 
            UpdateContext({CreditWindowVisble: true});
        Text: ="Credit"
        Visible: =PTWindowVisible
        Width: =181
        X: =718
        Y: =403
        ZIndex: =20

    Icon2 As icon.Cancel:
        Height: =27
        Icon: =Icon.Cancel
        OnSelect: |-
            =UpdateContext({PTWindowVisible: false}); 
            UpdateContext({BackgroundBlurVisble: false});
        Visible: =PTWindowVisible
        Width: =32
        X: =902
        Y: =340
        ZIndex: =21

    CreditWindow As rectangle:
        BorderColor: =RGBA(216, 59, 1, 1)
        BorderThickness: =5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =248
        Visible: =CreditWindowVisble
        Width: =480
        X: =443
        Y: =265
        ZIndex: =22

    lblCreditCardNum As label:
        FontWeight: =FontWeight.Bold
        Text: |-
            ="Credit Card #"
        Visible: =CreditWindowVisble
        Width: =139
        X: =461
        Y: =337
        ZIndex: =23

    inputCreditCardNum As text:
        Default: =""
        Format: =TextFormat.Number
        MaxLength: =16
        Visible: =CreditWindowVisble
        Width: =299
        X: =603
        Y: =337
        ZIndex: =24

    btnCreditSubmit As button:
        OnSelect: |+
            =If(Len(inputCreditCardNum.Text) = 16,
            UpdateContext({CreditWindowVisble: false}) & 
            UpdateContext({BackgroundBlurVisble: false}) &
            CheckoutProcess.Run(SelectedOrder.Table.HostTables), // Once submit, change order status to inactive.
            
            UpdateContext({ErrorWindowVisble: true})
            );
            
            // Note: can't seem to add patch function above.
            If(Len(inputCreditCardNum.Text) = 16,
                Patch(
                    Orders, 
                    LookUp(Orders, 'Order Number' = SelectedOrder.'Order Number'), 
                    {
                        Status: 'Status (Orders)'.Active
                    }
                )
            );
            
        Text: ="Submit"
        Visible: =CreditWindowVisble
        X: =742
        Y: =439
        ZIndex: =25

    exitCreditWindow As icon.Cancel:
        Height: =24
        Icon: =Icon.Cancel
        OnSelect: |-
            =UpdateContext({CreditWindowVisble: false});
            UpdateContext({BackgroundBlurVisble: false});
            
            Reset(inputCreditCardNum);
        Visible: =CreditWindowVisble
        Width: =34
        X: =889
        Y: =267
        ZIndex: =26

    ErrorWindow As rectangle:
        BorderColor: =RGBA(216, 59, 1, 1)
        BorderThickness: =5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =123
        Visible: =ErrorWindowVisble
        Width: =339
        X: =513
        Y: =322
        ZIndex: =27

    lblError As label:
        Fill: =RGBA(255, 255, 255, 1)
        FontWeight: =FontWeight.Bold
        Height: =29
        Text: |-
            ="Error: Invalid credit card number"
        Visible: =ErrorWindowVisble
        Width: =322
        X: =522
        Y: =338
        ZIndex: =28

    btnErrorConfirm As button:
        OnSelect: |-
            =UpdateContext({ErrorWindowVisble: false})
        Text: ="Confirm"
        Visible: =ErrorWindowVisble
        X: =603
        Y: =386
        ZIndex: =29

    CashWindow As rectangle:
        BorderColor: =RGBA(216, 59, 1, 1)
        BorderThickness: =5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =248
        Visible: =CashWindowVisible
        Width: =480
        X: =444
        Y: =262
        ZIndex: =30

    lblBalance As label:
        FontWeight: =FontWeight.Bold
        Height: =47
        Text: |-
            ="Balance: " & Text(SelectedOrder.'Grand Total', "$##.00")
        Visible: =CashWindowVisible
        Width: =183
        X: =493
        Y: =303
        ZIndex: =31

    lblCashAmt As label:
        FontWeight: =FontWeight.Bold
        Height: =52
        Text: |-
            ="Cash Amount: " 
        Visible: =CashWindowVisible
        Width: =139
        X: =493
        Y: =347
        ZIndex: =32

    inputCashAmt As text:
        Default: =""
        Format: =TextFormat.Number
        Height: =48
        Visible: =CashWindowVisible
        Width: =192
        X: =648
        Y: =351
        ZIndex: =33

    exitCreditWindow_1 As icon.Cancel:
        Height: =24
        Icon: =Icon.Cancel
        OnSelect: |-
            =UpdateContext({CashWindowVisible: false});
            Reset(inputCashAmt);
        Visible: =CashWindowVisible
        Width: =34
        X: =891
        Y: =267
        ZIndex: =34

    btnCashSubmit As button:
        OnSelect: |-
            =UpdateContext({CashWindowVisible: false});
            UpdateContext({ChangeWindowVisible: true});
            
            // Once submit, change order status to inactive.
            Patch(
                Orders, 
                LookUp(Orders, 'Order Number' = SelectedOrder.'Order Number'), 
                {
                    Status: 'Status (Orders)'.Active
                }
            );
            
            // Runs a cloud flow to change "Availability Status" Column to empty in the "HostTables" Table.
            CheckoutProcess.Run(SelectedOrder.Table.HostTables);
        Text: ="Submit"
        Visible: =CashWindowVisible
        X: =742
        Y: =439
        ZIndex: =35

    ChangeWindow As rectangle:
        BorderColor: =RGBA(216, 59, 1, 1)
        BorderThickness: =5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =179
        Visible: =ChangeWindowVisible
        Width: =220
        X: =582
        Y: =297
        ZIndex: =36

    lblChange As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Height: =63
        Size: =18
        Text: |-
            ="Change: " & Text(inputCashAmt - SelectedOrder.'Grand Total', "$#0.#0")
        Visible: =ChangeWindowVisible
        Width: =220
        X: =582
        Y: =314
        ZIndex: =37

    btnChange As button:
        OnSelect: |-
            =UpdateContext({ChangeWindowVisible: false});
            UpdateContext({BackgroundBlurVisble: false});
        Text: ="Confirm"
        Visible: =ChangeWindowVisible
        X: =612
        Y: =391
        ZIndex: =38

    Rectangle3 As rectangle:
        BorderColor: =RGBA(216, 59, 1, 1)
        BorderThickness: =5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =220
        Visible: =DiscountWindowVisble
        Width: =392
        X: =507
        Y: =267
        ZIndex: =39

    Button10_4 As button:
        Height: =34
        OnSelect: |-
            =UpdateContext({Discount: 10});
            UpdateContext({CustomizeClicked: false});
            Reset(inputCustomDiscount);
        Text: ="10%"
        Visible: =DiscountWindowVisble
        Width: =89
        X: =540
        Y: =317
        ZIndex: =40

    Button10_5 As button:
        Height: =34
        OnSelect: |-
            =UpdateContext({Discount: 25});
            UpdateContext({CustomizeClicked: false});
            Reset(inputCustomDiscount);
        Text: ="25%"
        Visible: =DiscountWindowVisble
        Width: =89
        X: =653
        Y: =317
        ZIndex: =41

    Button10_6 As button:
        Height: =34
        OnSelect: |-
            =UpdateContext({Discount: 50});
            UpdateContext({CustomizeClicked: false});
            Reset(inputCustomDiscount);
        Text: ="50%"
        Visible: =DiscountWindowVisble
        Width: =89
        X: =769
        Y: =316
        ZIndex: =42

    Button10_7 As button:
        DisplayMode: =DisplayMode.View
        Height: =34
        Text: ="Custom"
        Visible: =DiscountWindowVisble
        Width: =89
        X: =540
        Y: =386
        ZIndex: =43

    inputCustomDiscount As text:
        Default: =""
        Format: =TextFormat.Number
        Height: =34
        Visible: =DiscountWindowVisble
        Width: =94
        X: =648
        Y: =386
        ZIndex: =44

    Button10_8 As button:
        Height: =34
        OnSelect: |-
            =
            If(CustomizeClicked = true,
                Patch(Orders, LookUp(Orders, 'Order Number' = SelectedOrder.'Order Number'), {Discount: inputCustomDiscount/100}),
                Patch(Orders, LookUp(Orders, 'Order Number' = SelectedOrder.'Order Number'), {Discount: Discount/100});
            );
            
            UpdateContext({DiscountWindowVisble: false});
            UpdateContext({BackgroundBlurVisble: false});
        Text: ="Confirm"
        Visible: =DiscountWindowVisble
        Width: =89
        X: =771
        Y: =432
        ZIndex: =45

    Icon5 As icon.Cancel:
        Height: =32
        Icon: =Icon.Cancel
        OnSelect: |-
            =UpdateContext({DiscountWindowVisble: false});
            UpdateContext({BackgroundBlurVisble: false});
        Visible: =DiscountWindowVisble
        Width: =39
        X: =860
        Y: =265
        ZIndex: =46

    PaymentSuccessWindow As rectangle:
        BorderColor: =RGBA(216, 59, 1, 1)
        BorderThickness: =5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =123
        Visible: =ErrorWindowVisble
        Width: =339
        X: =512
        Y: =322
        ZIndex: =47

    lblPaymentSuccess As label:
        Align: =Align.Center
        Fill: =RGBA(255, 255, 255, 1)
        FontWeight: =FontWeight.Bold
        Height: =29
        Text: ="Payment success!"
        Visible: =ErrorWindowVisble
        Width: =322
        X: =521
        Y: =342
        ZIndex: =48

    btnSuccessConfirm As button:
        OnSelect: |-
            =UpdateContext({ErrorWindowVisble: false});
            UpdateContext({CreditWindowVisble: false}); 
            UpdateContext({BackgroundBlurVisble: false});
        Text: ="Confirm"
        Visible: =ErrorWindowVisble
        X: =604
        Y: =386
        ZIndex: =49

